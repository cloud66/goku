<!DOCTYPE html>
<html>
	<head>
		<meta charset='utf-8'>
		<meta http-equiv="X-UA-Compatible" content="chrome=1">
		<link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
		<link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
		<link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
		<!--[if lt IE 9]>
		<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
		<title>Goku | Process Manager Build for Scale | Cloud 66</title>
	</head>

	<body>
		<div id="container">
			<div class="inner">

				<header>
					<h1><a href="http://goku.cloud66.com">Goku</a></h1>
				</header>
				<hr class="short">
				<section id="main_content">
					<h3>
<a name="getting-started" class="anchor" href="#getting-started"><span class="octicon octicon-link"></span></a>Getting Started</h3>

<p>Getting started with Goku is easy.</p>

<h4>goku and gokud</h4>
<p>Goku comes in two parts: </p>
<ol>
<li><strong>gokud</strong> is the main engine. It owns, starts, stops and recycles the processes on the server.</li>
<li><strong>goku</strong> is the controller part. It uses <strong>gokud</strong> control API to allow you control the engine through command line if you want.</li>
</ol>

<p>goku communicates with gokud through <a href="http://json-rpc.org/">JSON-RPC</a> through HTTP. This menas you can write gokud API clients in almost any lauguage and integrate them into your own applications.</p>
<p>In this tutorial, <strong>Goku</strong> (with capital G) is used to refer to the project. <strong>goku</strong> and <strong>gokud</strong> are used to refer to the executables.</p>

<h4>Starting with Goku</h4>
<p>When installing Goku, you have two options: download the binaries or build it from the <a href="https://github.com/cloud66/goku">source</a>. Goku is written in Go so building it from the source is easy. We also provide compiled binaries for OS X and Linux (64-bit architecture only).</p>

<h5>Downloading Binaries</h5>
<ul>
<li><a href="http://downloads.cloud66.com/goku/goku_darwin_amd64.zip">goku OSX 64-bit</a></li>
<li><a href="http://downloads.cloud66.com/gokud/gokud_darwin_amd64.zip">gokud OSX 64-bit</a></li>
<li><a href="http://downloads.cloud66.com/goku/goku_linux_amd64.tar.gz">goku Linux 64-bit</a></li>
<li><a href="http://downloads.cloud66.com/gokud/gokud_linux_amd64.tar.gz">gokud Linux 64-bit</a></li>
</ul>

<p>Currently there are no plans to support and provide binaries for other platforms and architectures.</p>

<h5>Building from Source</h5>
<p>Clone the git repository and build it:</p>
<pre><code>$ git clone https://github.com/cloud66/goku.git goku
$ cd goku/gokud
$ go build
$ cd ../goku
$ go build
</code></pre>

<p>This will build both goku and gokud.</p>
<h3><a name="goku-configuration" class="anchor" href="#goku-configuration"><span class="octicon octicon-link"></span></a>Goku Configuration Files</h3>
<p>Goku uses <a href="https://github.com/mojombo/toml">toml</a> as the format for its configuration files. Toml is human readable and isn't too precious about tabs and spaces. Here is an example of a Goku configuraiton file:</p>

<pre><code># just a simple sleepy process
Name         = "My Sleepy Process"
Command      = "sleep"
Args         = ["1"]
</code></pre>

<p>This defines a simple process that runs the <code>sleep 1</code> command. The configuration file is self explainatory but some points might be worth mentioning:</p>
<ul>
	<li>Before running the process, Goku tries to find the exact location of the executable within <code>$PATH</code>. In this case it will run <code>/bin/sleep</code></li>
	<li>All arguments are passed in strings</li>
	<li>Name is used to refer to the process through the API</li>
</ul>

<p>Read <a href="configuration.html">Goku Configuraion Files</a> for detailed information about all the parameters in configuration files.</p>

<h3><a name="goku-configuration-directory" class="anchor" href="#goku-configuration-directory"><span class="octicon octicon-link"></span></a>Configuration Directory</h3>
<p>gokud expects all configuration toml files to be in the same directory. The path to this directory is passed into gokud with <code>-d</code> parameter when starting gokud.</p>

<pre><code>$ gokud -d /path/to/configuration/directory
</code></pre>

<p>Any file with <code>.toml</code> extension will be read and loaded. By default processes are not started when gokud starts. This can be changed with <code>-autostart</code>
parameter is used when starting gokud.</p>

<h3><a name="using-command-line" class="anchor" href="#using-command-line"><span class="octicon octicon-link"></span></a>Using Command Line</h3>
<p>gokud does not run as a daemon. This is intentional. We didn't want to build a replacement for <a href="http://upstart.ubuntu.com/">upstart</a> or <a href="https://wiki.debian.org/systemd">systemd</a> and wanted to make sure you can run gokud in the foreground if
you would like to debug your configuration files. If you would like to run gokud as a daemon, you can use Upstart or Systemd.
</p>
<p>Once you have gokud running, in a different terminal window, run the following command</p>
<pre><code>$ goku list
</code></pre>

<p>This should return something list this:</p>
<pre><code>Sidekiq       0  [worker]      unmonitored
Unicorn       0  [web worker]  unmonitored
ElasticSearch 0  [web search]  unmonitored
</code></pre>

<p>This shows the names of the processes loaded, their pid, their tags and status. Possible statuses are:</p>
<ul>
	<li>unmonitored</li>
	<li>unknown</li>
	<li>starting</li>
	<li>up</li>
	<li>stopping</li>
	<li>draining</li>
</ul>

<p>You can now try and start a process:</p>
<pre><code>$ goku start -p unicorn
</code></pre>
<p>or you can use the tags to start multiple processes with the <code>-t</code> parameter:</p>
<pre><code>$ goku start -t web
</code></pre>
<p>This will start both <strong>Unicorn</strong> and <strong>ElasticSearch</strong> processes.</p>
<p>You can also address processes by parts of their name as long as it results in a unique process:</p>
<pre><code>$ goku start -p u
</code></pre>
<p>This will start the <strong>Unicorn</strong> process.</p>

<p>Use the <code>stop</code> command to stop the process. This will start the StopSequence.</p>
<pre><code>$ goku stop -p unicorn
</code></pre>

<p>If your process supports draining, you can start recycling it with the <code>recycle</code> command:</p>
<pre><code>$ goku recycle -p unicorn
</code></pre>

<p>This will start draining the process while starting a new process with the same configuration. This means the pid you see in the <code>list</code>
command is always the pid of the <strong>active</strong> process. To see the list of all processes (<strong>active</strong> and <strong>draining</strong>), use
the <code>-v</code> option with the <code>list</code> command:</p>
<pre><code>$ goku list -v
</code></pre>

<h3><a name="goku-more" class="anchor" href="#goku-more"><span class="octicon octicon-link"></span></a>Getting More</h3>
<p>You can use the <code>help</code> command with both goku and gokud to see the list of all commands and options available.</p>

</section>

<footer>
	Goku is maintained by <a href="http://www.cloud66.com">Cloud 66</a><br>
</footer>
</div>
</div>
</body>
</html>
